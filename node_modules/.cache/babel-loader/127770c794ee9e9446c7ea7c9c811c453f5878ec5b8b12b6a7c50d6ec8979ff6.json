{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport axios from \"axios\";\nexport default {\n  data() {\n    const validateEmail = (rule, value, callback) => {\n      const emailPattern = /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$/;\n      if (!emailPattern.test(value)) {\n        return callback(new Error('请输入有效的邮箱地址'));\n      }\n      callback();\n    };\n    const validatePhone = (rule, value, callback) => {\n      if (!value || value.length !== 11 || !/^\\d{11}$/.test(value)) {\n        return callback(new Error('手机号需为11位数字'));\n      }\n      callback();\n    };\n    return {\n      username: '',\n      form: {\n        id: null,\n        dialogImageUrl: \"\",\n        dialogVisible: false,\n        fileParam: \"\",\n        username: '',\n        real_name: '',\n        gender: '',\n        email: '',\n        phone: '',\n        des: '',\n        description: ''\n      },\n      rules: {\n        email: [{\n          validator: validateEmail,\n          trigger: 'blur'\n        }],\n        phone: [{\n          validator: validatePhone,\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  mounted() {\n    const userInfo = JSON.parse(localStorage.getItem('userInfo'));\n    if (userInfo) {\n      this.username = userInfo.username;\n      this.getAdminInfo(userInfo.username);\n    }\n  },\n  methods: {\n    submitForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          this.modify();\n        } else {\n          console.log('表单验证失败');\n          return false;\n        }\n      });\n    },\n    modify() {\n      axios.put('http://192.168.57.26:5001/api/admin/update_info', this.form, {\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      }).then(res => {\n        if (res.data.code === 0) {\n          this.$message.success(\"修改成功\");\n        } else {\n          this.$message.error(\"修改失败：\" + res.data.message);\n        }\n      }).catch(error => {\n        console.error(error);\n        this.$message.error(\"修改失败:用户名已存在\");\n        this.clearRegisterForm(); // 清空表单\n      });\n    },\n\n    clearRegisterForm() {\n      this.form.username = '';\n    },\n    getAdminInfo(username) {\n      axios.get(`http://192.168.57.26:5001/api/admin/${username}`).then(res => {\n        if (res.data.code === 0) {\n          this.form = res.data.data;\n          this.dialogVisible = true;\n        } else {\n          this.$message.error('获取管理员信息失败');\n        }\n      }).catch(error => {\n        console.error(error);\n        this.$message.error('获取管理员信息失败，请稍后再试');\n      });\n    }\n  }\n};","map":{"version":3,"names":["axios","data","validateEmail","rule","value","callback","emailPattern","test","Error","validatePhone","length","username","form","id","dialogImageUrl","dialogVisible","fileParam","real_name","gender","email","phone","des","description","rules","validator","trigger","mounted","userInfo","JSON","parse","localStorage","getItem","getAdminInfo","methods","submitForm","formName","$refs","validate","valid","modify","console","log","put","headers","then","res","code","$message","success","error","message","catch","clearRegisterForm","get"],"sources":["src/views/page/manager/managerInfo.vue"],"sourcesContent":["<template>\r\n  <div style=\"width:500px;margin-left:270px;\">\r\n    <el-form style=\"height: 5px;\"></el-form>\r\n    <el-form style=\"height: 20px; margin-left: 250px; font-size: 25px; font-weight: bold;color: #676060\">个人中心</el-form>\r\n    <el-form ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"140px\" class=\"form\">\r\n      <el-form-item label=\"用户名\" prop=\"username\">\r\n        <el-input v-model=\"form.username\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"真实姓名\" prop=\"real_name\">\r\n        <el-input v-model=\"form.real_name\" :disabled=\"true\"></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"性别\" prop=\"gender\">\r\n        <el-input :value=\"form.gender === '0' ? '女' : '男'\" :disabled=\"true\"></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"邮箱\" prop=\"email\">\r\n        <el-input v-model=\"form.email\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"电话\" prop=\"phone\">\r\n        <el-input v-model=\"form.phone\" ></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"描述\" prop=\"description\">\r\n        <el-input v-model=\"form.description\" ></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item  style=\"width:100%;\">\r\n        <el-button type=\"primary\" @click=\"submitForm('form')\"  style=\"width:50%;margin-left:80px;margin-top:10px;border-color:#f39bbd;background-color: #f3aecd\">保存修改</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  data() {\r\n    const validateEmail = (rule, value, callback) => {\r\n      const emailPattern = /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$/;\r\n      if (!emailPattern.test(value)) {\r\n        return callback(new Error('请输入有效的邮箱地址'));\r\n      }\r\n      callback();\r\n    };\r\n\r\n    const validatePhone = (rule, value, callback) => {\r\n      if (!value || value.length !== 11 || !/^\\d{11}$/.test(value)) {\r\n        return callback(new Error('手机号需为11位数字'));\r\n      }\r\n      callback();\r\n    };\r\n\r\n    return {\r\n      username: '',\r\n      form: {\r\n        id: null,\r\n        dialogImageUrl: \"\",\r\n        dialogVisible: false,\r\n        fileParam: \"\",\r\n        username:'',\r\n        real_name:'',\r\n        gender:'',\r\n        email:'',\r\n        phone:'',\r\n        des:'',\r\n        description:''\r\n      },\r\n      rules: {\r\n        email: [{ validator: validateEmail, trigger: 'blur' }],\r\n        phone: [{ validator: validatePhone, trigger: 'blur' }]\r\n      }\r\n    };\r\n  },\r\n  mounted() {\r\n    const userInfo = JSON.parse(localStorage.getItem('userInfo'));\r\n    if (userInfo) {\r\n      this.username = userInfo.username;\r\n      this.getAdminInfo(userInfo.username);\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    submitForm(formName) {\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          this.modify();\r\n        } else {\r\n          console.log('表单验证失败');\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    modify() {\r\n      axios.put('http://192.168.57.26:5001/api/admin/update_info', this.form, {\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        }\r\n      }).then(res => {\r\n        if (res.data.code === 0) {\r\n          this.$message.success(\"修改成功\");\r\n        } else {\r\n          this.$message.error(\"修改失败：\" + res.data.message);\r\n        }\r\n      }).catch(error => {\r\n        console.error(error);\r\n\r\n        this.$message.error(\"修改失败:用户名已存在\");\r\n        this.clearRegisterForm(); // 清空表单\r\n      });\r\n    },\r\n    clearRegisterForm() {\r\n\r\n      this.form.username = '';\r\n\r\n    },\r\n    getAdminInfo(username) {\r\n      axios.get(`http://192.168.57.26:5001/api/admin/${username}`)\r\n          .then(res => {\r\n            if (res.data.code === 0) {\r\n              this.form = res.data.data;\r\n              this.dialogVisible = true;\r\n            } else {\r\n              this.$message.error('获取管理员信息失败');\r\n            }\r\n          })\r\n          .catch(error => {\r\n            console.error(error);\r\n            this.$message.error('获取管理员信息失败，请稍后再试');\r\n          });\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.page{\r\n  -webkit-border-radius: 5px;\r\n  border-radius: 5px;\r\n  margin: 180px auto;\r\n  border-top-right-radius: 4px;\r\n  border-bottom-right-radius: 4px;\r\n  width: 600px;\r\n  height: 596px;\r\n  padding: 35px 35px 15px;\r\n  background: #fff;\r\n  border: 1px solid #eaeaea;\r\n  margin-left: 238px;\r\n  box-shadow: 0 0 25px #cac6c6;\r\n}\r\n\r\n.form{\r\n  margin-top: 36px;\r\n}\r\n\r\n.disabled .el-upload--picture-card{\r\n  display: none;\r\n}\r\n</style>\r\n"],"mappings":";AAkCA,OAAAA,KAAA;AAEA;EACAC,KAAA;IACA,MAAAC,aAAA,GAAAA,CAAAC,IAAA,EAAAC,KAAA,EAAAC,QAAA;MACA,MAAAC,YAAA;MACA,KAAAA,YAAA,CAAAC,IAAA,CAAAH,KAAA;QACA,OAAAC,QAAA,KAAAG,KAAA;MACA;MACAH,QAAA;IACA;IAEA,MAAAI,aAAA,GAAAA,CAAAN,IAAA,EAAAC,KAAA,EAAAC,QAAA;MACA,KAAAD,KAAA,IAAAA,KAAA,CAAAM,MAAA,uBAAAH,IAAA,CAAAH,KAAA;QACA,OAAAC,QAAA,KAAAG,KAAA;MACA;MACAH,QAAA;IACA;IAEA;MACAM,QAAA;MACAC,IAAA;QACAC,EAAA;QACAC,cAAA;QACAC,aAAA;QACAC,SAAA;QACAL,QAAA;QACAM,SAAA;QACAC,MAAA;QACAC,KAAA;QACAC,KAAA;QACAC,GAAA;QACAC,WAAA;MACA;MACAC,KAAA;QACAJ,KAAA;UAAAK,SAAA,EAAAtB,aAAA;UAAAuB,OAAA;QAAA;QACAL,KAAA;UAAAI,SAAA,EAAAf,aAAA;UAAAgB,OAAA;QAAA;MACA;IACA;EACA;EACAC,QAAA;IACA,MAAAC,QAAA,GAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;IACA,IAAAJ,QAAA;MACA,KAAAhB,QAAA,GAAAgB,QAAA,CAAAhB,QAAA;MACA,KAAAqB,YAAA,CAAAL,QAAA,CAAAhB,QAAA;IACA;EACA;EAEAsB,OAAA;IACAC,WAAAC,QAAA;MACA,KAAAC,KAAA,CAAAD,QAAA,EAAAE,QAAA,CAAAC,KAAA;QACA,IAAAA,KAAA;UACA,KAAAC,MAAA;QACA;UACAC,OAAA,CAAAC,GAAA;UACA;QACA;MACA;IACA;IACAF,OAAA;MACAvC,KAAA,CAAA0C,GAAA,yDAAA9B,IAAA;QACA+B,OAAA;UACA;QACA;MACA,GAAAC,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAA5C,IAAA,CAAA6C,IAAA;UACA,KAAAC,QAAA,CAAAC,OAAA;QACA;UACA,KAAAD,QAAA,CAAAE,KAAA,WAAAJ,GAAA,CAAA5C,IAAA,CAAAiD,OAAA;QACA;MACA,GAAAC,KAAA,CAAAF,KAAA;QACAT,OAAA,CAAAS,KAAA,CAAAA,KAAA;QAEA,KAAAF,QAAA,CAAAE,KAAA;QACA,KAAAG,iBAAA;MACA;IACA;;IACAA,kBAAA;MAEA,KAAAxC,IAAA,CAAAD,QAAA;IAEA;IACAqB,aAAArB,QAAA;MACAX,KAAA,CAAAqD,GAAA,wCAAA1C,QAAA,IACAiC,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAA5C,IAAA,CAAA6C,IAAA;UACA,KAAAlC,IAAA,GAAAiC,GAAA,CAAA5C,IAAA,CAAAA,IAAA;UACA,KAAAc,aAAA;QACA;UACA,KAAAgC,QAAA,CAAAE,KAAA;QACA;MACA,GACAE,KAAA,CAAAF,KAAA;QACAT,OAAA,CAAAS,KAAA,CAAAA,KAAA;QACA,KAAAF,QAAA,CAAAE,KAAA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}